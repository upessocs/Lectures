

# Experiment 9: Shell Programming

## Theory

### 1. System Performance Monitoring

System performance is tracked using CPU, memory, disk, and network usage.
**Useful commands:**

* `top` → live CPU & memory usage per process.
* `htop` → improved version of `top` (if installed).
* `free -h` → memory usage in human-readable form.
* `df -h` → disk space usage.
* `iostat` → input/output statistics (may need `sysstat` package).
* `uptime` → system load averages (1, 5, 15 minutes).

### 2. System Security and User Management

Linux is **multi-user**. Security involves controlling file permissions, users, and groups.
**Important commands:**

* `whoami` → current user.
* `id` → user & group info.
* `adduser <name>` → add new user.
* `passwd <name>` → set/change password.
* `groups` → display user’s groups.
* `chmod` → change permissions (r, w, x).
* `chown` → change ownership.

Example:

```bash
chmod 755 script.sh   # owner rwx, group r-x, others r-x
```

---

## Lab

### i. Rename All Files in a Directory

```bash
#!/bin/bash
echo "Enter directory path:"
read dir
echo "Enter prefix or suffix to add:"
read add

cd "$dir" || { echo "Directory not found!"; exit 1; }

for file in *; do
    if [ -f "$file" ]; then
        mv "$file" "${add}_$file"
    fi
done
echo "Files renamed successfully."
```

**Explanation:**

* `cd "$dir"` → move into directory.
* `for file in *` → iterate over all files.
* `mv old new` → rename file.

---

### ii. Search Files by Extension or Size

```bash
#!/bin/bash
echo "Enter directory to search:"
read dir
echo "Enter file extension (e.g. .txt):"
read ext
echo "Enter minimum size in KB:"
read size

find "$dir" -type f -name "*$ext" -size +"${size}k"
```

**New Command:**

* `find` searches files:

  * `-type f` → files only.
  * `-name "*.txt"` → by extension.
  * `-size +100k` → larger than 100 KB.

---

### iii. Fibonacci Series

```bash
#!/bin/bash
echo "Enter the number of terms:"
read n

a=0
b=1
echo "Fibonacci Series:"
for ((i=0; i<n; i++))
do
    echo -n "$a "
    fn=$((a + b))
    a=$b
    b=$fn
done
echo
```

**Explanation:**

* Fibonacci starts with 0, 1.
* Each term = sum of previous two.

---

## Assignment (Experiment 9)

1. Write a script to find the largest file in a given directory.
2. Create a script that counts how many `.sh` files exist in `/home/user`.
3. Write a script to monitor CPU usage every 10 seconds and log to a file.
4. Create a script that adds a new user and sets default permissions for their home directory.

---

# Experiment 10: Shell Programming

## Theory

### 1. Modular and Reusable Code

Shell scripts can be **modular** using:

* **Functions** → reusable blocks of code.
* **Sourcing (`. file` or `source file`)** → include external scripts.

Example:

```bash
source utils.sh
my_function
```

### 2. Script Optimization

* Avoid unnecessary subshells (`$(...)` only when needed).
* Use built-in string operators instead of external commands (`expr`, `awk`).
* Minimize loops by using shell expansion or built-ins.

---

## Lab

### i. String Length

```bash
#!/bin/bash
echo "Enter a string:"
read str
echo "Length: ${#str}"
```

### ii. Reverse String

```bash
#!/bin/bash
echo "Enter a string:"
read str
rev=""
len=${#str}
for (( i=$len-1; i>=0; i-- ))
do
    rev="$rev${str:$i:1}"
done
echo "Reversed: $rev"
```

### iii. Concatenate Strings

```bash
#!/bin/bash
echo "Enter first string:"
read s1
echo "Enter second string:"
read s2
echo "Concatenated: $s1$s2"
```

---

## Assignment (Experiment 10)

1. Write a function in a separate script (`math.sh`) to calculate factorial. Import it into another script.
2. Optimize the Fibonacci script (from Exp. 9) to use functions.
3. Write a script that finds the length of all filenames in a directory.

---

# Experiment 11: Shell Programming

## Theory

### 1. Interacting with Users

* `read` → take input.
* `select` → interactive menus.

### 2. Parsing and Processing Data Formats

* Use `cut`, `awk`, `sed` to extract/transform data.
* Example:

```bash
echo "name,age" | cut -d',' -f1
```

### 3. Interacting with Databases

* Shell can interact with MySQL/PostgreSQL.
  Example (MySQL):

```bash
mysql -u user -p -e "SELECT * FROM students;"
```

---

## Lab

### i. Split Sentence into Words

```bash
#!/bin/bash
echo "Enter a sentence:"
read sentence
for word in $sentence; do
    echo "$word"
done
```

### ii. Palindrome Check

```bash
#!/bin/bash
echo "Enter string:"
read str
rev=$(echo "$str" | rev)

if [ "$str" = "$rev" ]; then
    echo "Palindrome"
else
    echo "Not palindrome"
fi
```

---

## Assignment (Experiment 11)

1. Write a script to read a CSV file and print only the first column.
2. Create a script that asks the user to select an option from a menu and performs corresponding action.
3. Write a script that checks if a word exists in a dictionary file (`/usr/share/dict/words`).

---

# Experiment 12: Building a Rule-Based Expert System

## Theory

### Process Automation and Job Scheduling

* `cron` → schedule repetitive tasks.

  * Edit with `crontab -e`.
  * Example: `0 9 * * * /home/user/backup.sh` → run at 9 AM daily.
* `at` → one-time jobs.

### System Administration Scripts

Scripts for:

* Backups
* User creation
* Log monitoring

### Services and Daemons

* `systemctl start service`
* `systemctl stop service`
* `systemctl status service`

---

## Lab

### Expert System Script

```bash
#!/bin/bash
echo "Welcome to the Expert System"
echo "Enter your symptoms (fever, sore_throat, cough):"
read symptoms

if [[ "$symptoms" == *"fever"* ]]; then
    echo "Recommendation: Take fever reducer medication."
fi
if [[ "$symptoms" == *"sore_throat"* ]]; then
    echo "Recommendation: Gargle with warm saltwater."
fi
if [[ "$symptoms" == *"cough"* || "$symptoms" == *"congestion"* ]]; then
    echo "Recommendation: Drink warm fluids and take cough syrup."
fi

if [[ "$symptoms" != *"fever"* && "$symptoms" != *"sore_throat"* && "$symptoms" != *"cough"* ]]; then
    echo "General Recommendation: Consult a doctor for accurate diagnosis."
fi
```

---

## Assignment (Experiment 12)

1. Extend the expert system to cover **headache, cold, stomach pain** with suitable advice.
2. Schedule the script to run every day at 8 AM using `cron`.
3. Modify the system so that multiple recommendations can be displayed at once.
4. Write a report documenting rules, logic, and improvements made.

